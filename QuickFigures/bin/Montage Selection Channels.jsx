var ci=0;// Save the current preferencesvar startRulerUnits = app.preferences.rulerUnitsvar startTypeUnits = app.preferences.typeUnitsvar startDisplayDialogs = app.displayDialogs// Set Adobe Photoshop CS5 to use pixels and display no dialogsapp.preferences.rulerUnits = Units.PIXELSapp.preferences.typeUnits = TypeUnits.PIXELSapp.displayDialogs = DialogModes.NOvar distanceOX=500;var borderW=10;var borderFactor=1;var Mergep=true;try{    borderW=borderWidth;    Mergep=mergeFirst;    } catch(err) {}// Copyright 2002-2007.  Adobe Systems, Incorporated.  All rights reserved.// Make the Red and Blue channels the active channels,// enable double clicking from the Macintosh Finder or the Windows Explorer#target photoshop// in case we double clicked the fileapp.bringToFront();// on localized builds we pull the $$$/Strings from a .dat file, see documentation for more details$.localize = true;var strChannelRed = localize("$$$/ColorModes/RGB/ChannelName/Red=Red");var strChannelBlue = localize("$$$/ColorModes/RGB/ChannelName/Blue=Blue");var strChannelGreen = localize("$$$/ColorModes/RGB/ChannelName/Green=Green");if (!app.documents.length > 0) {    // open sample file if no document is opened.	var strSamplesFolderDirectory = localize( "$$$/LocalizedFilenames.xml/SourceDirectoryName/id/Extras/[LOCALE]/[LOCALE]_Samples/value=Samples" );	var strSampleFileNameLayerComps = localize ("$$$/LocalizedFilenames.xml/SourceFileName/id/Extras/[LOCALE]/[LOCALE]_Samples/Layer_Comps.psd/value=Layer Comps.psd");	var fileName = app.path.toString() + "/" + strSamplesFolderDirectory + "/" + strSampleFileNameLayerComps;    var docRef = open( File(fileName) );}var colorChans=false;docRef = app.activeDocument;var layerRef=app.activeDocument.activeLayer;var selectionRef=app.activeDocument.selection;var boundRef2=app.activeDocument.selection.bounds;var boundRef=new Array(boundRef2[0].value, boundRef2[1].value, boundRef2[2].value, boundRef2[3].value);var h=boundRef2[0].value;var v=boundRef2[1].value;var lastH=(boundRef2[2].value-boundRef2[0].value);var lastV=(boundRef2[3].value-boundRef2[1].value);distanceOX=lastH*borderFactor+borderW;//alert("The bounds are "+boundRef[0]+"  "+boundRef[1]+"  "+boundRef[2]+"  "+boundRef[3]+"  "+boundRef[4])try{selectionRef.copy();if (Mergep) {app.activeDocument.artLayers.add();app.activeDocument.paste();}layerRef=app.activeDocument.activeLayer;app.activeDocument.selection.selectAll();} catch (err){}selRegion = Array(Array(h, v),Array(h + lastH, v),Array(h + lastH, v + lastV),Array(h, v + lastV),Array(h, v)); app.activeDocument.selection.select(selRegion);var theOrigChannels= new Array(docRef.channels[strChannelGreen], docRef.channels[strChannelBlue], docRef.channels[strChannelRed]);//, theChannels = new Array(docRef.channels[strChannelRed]);//, docRef.activeChannels = theChannels;app.activeDocument.selection.copy();if (colorChans) docRef.activeChannels = theOrigChannels; else app.activeDocument.artLayers.add();app.activeDocument.selection.select(selRegion);app.activeDocument.paste();app.activeDocument.activeLayer.translate(new UnitValue( distanceOX+" pixels"  ), new UnitValue( "0 pixels" ));app.activeDocument.activeLayer=layerRef;app.activeDocument.selection.select(selRegion);theChannels = new Array(docRef.channels[strChannelGreen]);//, docRef.activeChannels = theChannels;app.activeDocument.selection.copy();if (colorChans) docRef.activeChannels = theOrigChannels; else app.activeDocument.artLayers.add();app.activeDocument.selection.select(selRegion);app.activeDocument.paste();app.activeDocument.activeLayer.translate(new UnitValue(distanceOX*2+" pixels"  ), new UnitValue( "0 pixels" ));app.activeDocument.activeLayer=layerRef;app.activeDocument.selection.select(selRegion);theChannels = new Array(docRef.channels[strChannelBlue]);//, docRef.activeChannels = theChannels;app.activeDocument.selection.copy();if (colorChans) docRef.activeChannels = theOrigChannels; else app.activeDocument.artLayers.add();app.activeDocument.selection.select(selRegion);app.activeDocument.paste();app.activeDocument.activeLayer.translate(new UnitValue( distanceOX*3+" pixels"  ), new UnitValue( "0 pixels" ));app.activeDocument.activeLayer=layerRef;app.activeDocument.selection.select(selRegion);theChannels = new Array(docRef.channels[strChannelBlue], docRef.channels[strChannelGreen], docRef.channels[strChannelRed]);//, docRef.activeChannels = theChannels;app.activeDocument.selection.copy();if (colorChans) docRef.activeChannels = theOrigChannels; else app.activeDocument.artLayers.add();app.activeDocument.selection.select(selRegion);if (!Mergep)  {app.activeDocument.paste();app.activeDocument.activeLayer.translate(new UnitValue( distanceOX*4+" pixels"  ), new UnitValue( "0 pixels" ));}app.activeDocument.selection.select(selRegion);/**app.activeDocument.selection.translate(new UnitValue( "-500 pixels"  ), new UnitValue( "0 pixels" ));theChannels = new Array(docRef.channels[strChannelGreen]);//, docRef.activeChannels = theChannels;//app.activeDocument.selection.selectAll();app.activeDocument.selection.copy();app.activeDocument.selection.translate(new UnitValue( "1000 pixels"  ), new UnitValue( "0 pixels" ));theChannels = new Array(docRef.channels[strChannelRed], docRef.channels[strChannelBlue], docRef.channels[strChannelGreen]);//, docRef.channels[strChannelBlue]docRef.activeChannels = theChannels;app.activeDocument.paste();app.activeDocument.activeLayer=layerRef;app.activeDocument.selection=selectionRef;app.activeDocument.selection.translate(new UnitValue( "-1000 pixels"  ), new UnitValue( "0 pixels" ));app.activeDocument.selection.select(selectionRef.bounds)theChannels = new Array(docRef.channels[strChannelBlue]);//, docRef.activeChannels = theChannels;//app.activeDocument.selection.selectAll();app.activeDocument.selection.copy();app.activeDocument.selection.translate(new UnitValue( "1500 pixels"  ), new UnitValue( "0 pixels" ));theChannels = new Array(docRef.channels[strChannelRed], docRef.channels[strChannelBlue], docRef.channels[strChannelGreen]);//, docRef.channels[strChannelBlue]docRef.activeChannels = theChannels;app.activeDocument.paste();*/